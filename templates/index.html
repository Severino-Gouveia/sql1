<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório Diário de Manutenção</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <!-- Incluindo jQuery e Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    
    <!-- Incluindo Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Incluindo jQuery UI para o widget de calendário -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <!-- Incluindo DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css">

    <!-- Incluindo jQuery, Popper.js, Bootstrap, DataTables e autoNumeric JS -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autoNumeric/4.5.6/autoNumeric.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/i18n/jquery-ui-i18n.min.js"></script>
  
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/i18n/jquery-ui-i18n.min.js"></script>

  </head>

  <style>
    body {
        margin: 0;
    }
    .containe {
        margin: 5px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 1);
        overflow: hidden;
        margin-top: 8px;
        text-align: center;
        
    }
 
    th,
    td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
    }

    #reportTitle {
       
        color: #3498db;
    }
    .hidden {
        display: none;
    }
    
</style>

</head>

<body>
  
       <div class="pos-f-t">
        <div class="collapse" id="navbarToggleExternalContent">
            <div class="bg-dark p-4 text-light ">
                <div class="nav-item dropdown" id="departamentoDropdown">
                    
                        <a class="nav-link dropdown-toggle p-4 w-25" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Filtrar Departamento
                        </a>
                        <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="{{ url_for('filtrar_departamento', departamento='DP01') }}">DP01</a>
                            <a class="dropdown-item" href="{{ url_for('filtrar_departamento', departamento='DP02') }}">DP02</a>
                            <a class="dropdown-item" href="{{ url_for('filtrar_departamento', departamento='DP03') }}">DP03</a>
                            
                        </div>
                    
                </div>
              </div>
              <div class="bg-dark p-4 text-light">
                <div class="bg-dark p-4 text-light">
                <p class="card-text">Pesquisar por data</p>
                <form class="d-flex" role="search">
                    <!-- Adicione um campo de entrada de texto formatado para a data -->
                    <input class="form-control me-2 w-25" type="text" id="datepicker" placeholder="DD/MM/YYYY" oninput="restrictInput(this)">
                    <!-- Adicione um botão que, quando clicado, abrirá o calendário -->
                    <button class="btn btn-outline-success" type="button" id="open-calendar">Pesquisar</button>
                </form>
            </div>
            </div>
            
          
        </div>
        <nav class="navbar navbar-dark" style="background-color: #3498db;">
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
        </nav>
      </div>
        
    </nav>

    <div class="containe">
        <div class="row">
            <div class="col-12 p-5">
                <img src="{{ url_for('static', filename=imagem_path) }}" alt="Assinatura GPTW">

            </div>
    </div>
    <div class="containe">
            <div class="col-12 p-5" id="reportTitle">
                <h1 class="card-title">Relatório Diário de Manutenção e Operação {{ data[0]['Departamento'] }}</h1>
                <h1 class="card-title">Semana: {{ data[0]['Semana'] }} Data: {{ data[0]['Data'] }}</h2>
            </div>
            
    </div>
    <div class="containe">
        <div class="row">
            <div class="col-md-12">
                <div class="table-responsive">
                    <table id="dataTable" class="table">
                        <thead>
                            <tr>
                                {% for header in data[0].keys() %}
                                <th>{{ header }}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in data %}
                            <tr class="toggle-row clickable-row">
                                {% for cell in row.values() %}
                                <td>{{ cell }}</td>
                                {% endfor %}
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script>
 // Set the language to Portuguese for the datepicker
 $.datepicker.setDefaults($.datepicker.regional['pt-BR']);

 // Initialize the datepicker
 $(function () {
     $("#datepicker").datepicker({
         dateFormat: "dd/mm/yy", // Set the desired date format
         showOtherMonths: true,
         selectOtherMonths: true,
         monthNames: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
         dayNamesMin: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb']
     });
 });

 // Function to restrict input to numeric characters and '/'
 function restrictInput(input) {
     input.value = input.value.replace(/[^0-9/]/g, '');
 }
 // Função para restringir a entrada a números
            function restrictInput(input) {
            var formattedDate = input.value.replace(/\D/g, '').replace(/(\d{2})(\d{0,2})(\d{0,4})/, '$1/$2/$3');
            input.value = formattedDate.substring(0, 10); // Limita o comprimento a 10 caracteres
        }

        $(function () {
            // Inicialize o widget de calendário
            $("#datepicker").datepicker();

            // Inicialize o campo de entrada com formatação automática para data
            $('#datepicker').autoNumeric('init', {
                aSep: '',
                aSign: '',
                vMin: '0',
                vMax: '9999999999',
                mDec: 0
            });

            // Lógica para processar a entrada manual da data ou a data selecionada no calendário
            $("#open-calendar").on("click", function () {
                // Verifique se há uma data selecionada no widget de calendário
                var selectedDate = $("#datepicker").datepicker("getDate");

                if (selectedDate) {
                    // Ação desejada para a data selecionada
                    console.log("Data selecionada:", selectedDate);
                } else {
                    // Se nenhum data for selecionada, obtenha a data manualmente
                    var manualDate = $("#datepicker").val();
                    // Implemente a lógica de pesquisa ou ação desejada com a data manual
                    console.log("Data inserida manualmente:", manualDate);
                }
            });
        });

        document.addEventListener('DOMContentLoaded', function () {
            // Ocultar as colunas 'Semana', 'Data', e 'Departamento' inicialmente
            var headerCells = document.querySelectorAll('#dataTable th');
            var dataCells = document.querySelectorAll('#dataTable td');

            headerCells.forEach(function (cell, index) {
                if (cell.textContent === 'Semana' || cell.textContent === 'Data' || cell.textContent === 'Departamento') {
                    cell.classList.add('hidden');
                    dataCells.forEach(function (dataCell) {
                        if (dataCell.cellIndex === index) {
                            dataCell.classList.add('hidden');
                        }
                    });
                }
            });

            // Initialize DataTables
            $('#dataTable').DataTable({
                "responsive": true,
                "autoWidth": false
            });
        });
        
    </script>
</body>

</html>
